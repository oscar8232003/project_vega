CREATE TRIGGER `crear_actualizar_local` AFTER UPDATE ON `registration_tipo_usuarios`
 FOR EACH ROW BEGIN
declare verificador int;
declare tipo_antiguo varchar(20) ;
declare tipo_nuevo varchar(20);
set verificador = 0;
set tipo_antiguo = old.tipo_usuario;
set tipo_nuevo = new.tipo_usuario;
select count(*)
into verificador
from vendedor_local
where user_id=new.user_id_id;

if tipo_antiguo != tipo_nuevo then
    IF tipo_antiguo = 'cliente' and tipo_nuevo = 'vendedor' THEN
    	if verificador = 0 then
    		insert into vendedor_local (nombre_local, ubicacion_local, imagen_muestra, imagen_banner, user_id, activado) values ("Sin definir", "Sin definir","core/sin_imagen.jpg", "core/sin_imagen.jpg",new.user_id_id, true);
    	else
            update vendedor_local
            set activado = true
            where user_id = new.user_id_id;
        end if;   
    else
        update vendedor_local
        set activado = false
        where user_id = new.user_id_id;

        update vendedor_productos
        set activado = false
        where user_id = new.user_id_id;
     end if;
end if;

END

CREATE TRIGGER `insertar_tipo` AFTER INSERT ON `auth_user`
 FOR EACH ROW insert into registration_tipo_usuarios (tipo_usuario, tipo_premium, fecha_caducidad, user_id_id) values ("cliente", 0, now(), new.id)

CREATE TRIGGER `delete_tipo` BEFORE DELETE ON `auth_user`
 FOR EACH ROW delete from registration_tipo_usuarios where user_id_id = OLD.username
